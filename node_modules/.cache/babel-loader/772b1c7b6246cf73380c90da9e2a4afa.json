{"ast":null,"code":"import _defineProperty from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import'./Input.css';import Media from'react-media';import{useForm}from'react-hook-form';import{useNavigate}from'react-router-dom';import{doc,getDocs,collection,getDoc,updateDoc,increment}from\"firebase/firestore\";import{db}from'../../../firebase';import{phoneX}from'../../../Sign/Input';import{sendPhone}from'../../../ValidExFran/Input';import{frais,Unite,solde,money}from'../../../FC/Input';import Button from'@mui/material/Button';import Dialog from'@mui/material/Dialog';import DialogActions from'@mui/material/DialogActions';import DialogContent from'@mui/material/DialogContent';import DialogTitle from'@mui/material/DialogTitle';import DialogContentText from'@mui/material/DialogContentText';import moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var prixHash=0;export var hashTrue=true;// Input Field Component \nexport default function ReturnInput(){return/*#__PURE__*/_jsx(Media,{queries:{small:'(max-width: 599px)',medium:'(min-width: 600px) and (max-width:1199px)',large:'(min-width: 1200px)'},children:function children(matches){return/*#__PURE__*/_jsxs(_Fragment,{children:[matches.small&&/*#__PURE__*/_jsx(ScreenSmall,{}),matches.medium&&/*#__PURE__*/_jsx(SreenLarge,{}),matches.large&&/*#__PURE__*/_jsx(SreenLarge,{})]});}});};export var SreenLarge=function SreenLarge(){return/*#__PURE__*/_jsx(\"div\",{className:\"wrp-input-phone-register\",children:/*#__PURE__*/_jsx(FormInput,{})});};export var ScreenSmall=function ScreenSmall(){return/*#__PURE__*/_jsx(\"div\",{className:\"wrp-input-phone-register-sm\",children:/*#__PURE__*/_jsx(FormInput,{})});};export var FormInput=function FormInput(){var pushDocs=new Array();var verifierSend;var verifierGet;var navigation=useNavigate();var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,reset=_useForm.reset;// send React useState  \nvar _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),pin=_React$useState2[0],setPin=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),state=_React$useState4[0],setState=_React$useState4[1];var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),first=_React$useState6[0],setFirst=_React$useState6[1];var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),last=_React$useState8[0],setLast=_React$useState8[1];// getting React useState\nvar _React$useState9=React.useState(null),_React$useState10=_slicedToArray(_React$useState9,2),getstate=_React$useState10[0],setGetstate=_React$useState10[1];var _React$useState11=React.useState(''),_React$useState12=_slicedToArray(_React$useState11,2),getfirst=_React$useState12[0],setGetFirst=_React$useState12[1];var _React$useState13=React.useState(''),_React$useState14=_slicedToArray(_React$useState13,2),getlast=_React$useState14[0],setGetLast=_React$useState14[1];var _React$useState15=React.useState(false),_React$useState16=_slicedToArray(_React$useState15,2),open=_React$useState16[0],setOpen=_React$useState16[1];var _React$useState17=React.useState(true),_React$useState18=_slicedToArray(_React$useState17,2),fullWidth=_React$useState18[0],setFullWidth=_React$useState18[1];var _React$useState19=React.useState('sm'),_React$useState20=_slicedToArray(_React$useState19,2),maxWidth=_React$useState20[0],setMaxWidth=_React$useState20[1];var handleClickOpen=function handleClickOpen(){setOpen(true);};var handleClose=function handleClose(){setOpen(false);};React.useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var querySnapshot,sendRef,sendSnap,getRef,getSnap;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getDocs(collection(db,\"client\"));case 2:querySnapshot=_context.sent;querySnapshot.forEach(function(doc){pushDocs.push(doc.id);});verifierSend=pushDocs.some(function(value){return value==phoneX;});verifierGet=pushDocs.some(function(value){return value==sendPhone;});sendRef=doc(db,verifierSend?\"client\":\"agent\",phoneX);_context.next=9;return getDoc(sendRef);case 9:sendSnap=_context.sent;if(sendSnap.exists()){setPin(sendSnap.data().code);setState(sendSnap.data().state);setFirst(sendSnap.data().firstname);setLast(sendSnap.data().lastname);};getRef=doc(db,verifierGet?\"client\":\"agent\",sendPhone);_context.next=15;return getDoc(getRef);case 15:getSnap=_context.sent;if(getSnap.exists()){setGetstate(getSnap.data().state);setGetFirst(getSnap.data().firstname);setGetLast(getSnap.data().lastname);};case 18:case\"end\":return _context.stop();}}},_callee);})),[]);var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var sendUser,getUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// Checked if value code is length valid\nif(data.code.length!=6||pin!=data.code){setOpen(true);reset();}else{sendUser=first.toLowerCase()+' '+last.toLowerCase();getUser=getfirst.toLowerCase()+' '+getlast.toLowerCase();if(state==\"agent\"&&getstate==\"agent\"){hashTrue=false;prixHash=solde;console.log('agent');swapInWithDocsAgent(phoneX,sendPhone,sendUser,getUser,solde,Unite);navigation('/send-success-blocked');}else if(state==\"client\"&&getstate==\"client\"){hashTrue=true;prixHash=money;isSwapInWithClientToClient(phoneX,sendPhone,sendUser,getUser,solde,money,Unite);navigation('/send-success-blocked');}else{if(state==\"agent\"){hashTrue=false;prixHash=solde;console.log('agent');swapInWithDocsAgentToClient(phoneX,sendPhone,sendUser,getUser,solde,Unite);navigation('/send-success-blocked');}else{hashTrue=true;prixHash=money;isSwapInWithClientToAgent(phoneX,sendPhone,sendUser,getUser,solde,money,Unite);console.log('other');navigation('/send-success-blocked');}}}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"password\",placeholder:\"Code\",name:\"code\"},register('code',{required:true}))),/*#__PURE__*/_jsxs(Dialog,{fullWidth:fullWidth,maxWidth:maxWidth,open:open,onClose:handleClose,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"MuunganoMoney\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(DialogContentText,{children:\"Code d'acc\\xE8s refus\\xE9. Veuillez v\\xE9rifier\"})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:handleClose,children:\"Fermer\"})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"Btn\",children:\"Valider\"})]});};function swapInWithDocsAgent(_x2,_x3,_x4,_x5,_x6,_x7){return _swapInWithDocsAgent.apply(this,arguments);}function _swapInWithDocsAgent(){_swapInWithDocsAgent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(sendPhone,getPhone,sendUser,getUser,prix,unite){var sendRef,getRef;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:sendRef=doc(db,\"agent\",sendPhone);_context3.next=3;return updateDoc(sendRef,{cdf:increment(-prix),money:prix,user:getUser,unite:unite,phoneclient:getPhone,delay:moment().format()});case 3:getRef=doc(db,\"agent\",getPhone);_context3.next=6;return updateDoc(getRef,{thriftcdf:increment(prix),money:prix,user:sendUser,unite:unite,phoneclient:sendPhone,delay:moment().format()});case 6:case\"end\":return _context3.stop();}}},_callee3);}));return _swapInWithDocsAgent.apply(this,arguments);};function swapInWithDocsAgentToClient(_x8,_x9,_x10,_x11,_x12,_x13){return _swapInWithDocsAgentToClient.apply(this,arguments);}function _swapInWithDocsAgentToClient(){_swapInWithDocsAgentToClient=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(sendPhone,getPhone,sendUser,getUser,prix,unite){var sendRef,getRef;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:sendRef=doc(db,\"agent\",sendPhone);_context4.next=3;return updateDoc(sendRef,{cdf:increment(-prix),money:prix,user:getUser,unite:unite,phoneclient:getPhone,delay:moment().format()});case 3:getRef=doc(db,\"client\",getPhone);_context4.next=6;return updateDoc(getRef,{thriftcdf:increment(prix),money:prix,user:sendUser,unite:unite,phoneclient:sendPhone,delay:moment().format()});case 6:case\"end\":return _context4.stop();}}},_callee4);}));return _swapInWithDocsAgentToClient.apply(this,arguments);};function isSwapInWithClientToAgent(_x14,_x15,_x16,_x17,_x18,_x19,_x20){return _isSwapInWithClientToAgent.apply(this,arguments);}function _isSwapInWithClientToAgent(){_isSwapInWithClientToAgent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(sendPhone,getPhone,sendUser,getUser,prix,money,unite){var _updateDoc;var sendRef,getRef,adminRef;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:sendRef=doc(db,\"client\",sendPhone);_context5.next=3;return updateDoc(sendRef,{cdf:increment(-prix),money:money,user:getUser,unite:unite,phoneclient:getPhone,delay:moment().format()});case 3:getRef=doc(db,\"agent\",getPhone);_context5.next=6;return updateDoc(getRef,(_updateDoc={thriftcdf:increment(money),money:money,user:sendUser,unite:unite},_defineProperty(_updateDoc,\"thriftcdf\",increment(Math.floor(Number(frais*30/100)))),_defineProperty(_updateDoc,\"phoneclient\",sendPhone),_defineProperty(_updateDoc,\"delay\",moment().format()),_updateDoc));case 6:adminRef=doc(db,\"muunganomoney\",\"money\");_context5.next=9;return updateDoc(adminRef,{cdf:increment(Math.floor(Number(frais*70/100)))});case 9:case\"end\":return _context5.stop();}}},_callee5);}));return _isSwapInWithClientToAgent.apply(this,arguments);};function isSwapInWithClientToClient(_x21,_x22,_x23,_x24,_x25,_x26,_x27){return _isSwapInWithClientToClient.apply(this,arguments);}function _isSwapInWithClientToClient(){_isSwapInWithClientToClient=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(sendPhone,getPhone,sendUser,getUser,prix,money,unite){var sendRef,getRef,adminRef;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:sendRef=doc(db,\"client\",sendPhone);_context6.next=3;return updateDoc(sendRef,{cdf:increment(-prix),money:money,user:getUser,unite:unite,phoneclient:getPhone,delay:moment().format()});case 3:getRef=doc(db,\"client\",getPhone);_context6.next=6;return updateDoc(getRef,{thriftcdf:increment(money),money:money,user:sendUser,unite:unite,phoneclient:sendPhone,delay:moment().format()});case 6:adminRef=doc(db,\"muunganomoney\",\"money\");_context6.next=9;return updateDoc(adminRef,{cdf:increment(Math.floor(Number(frais)))});case 9:case\"end\":return _context6.stop();}}},_callee6);}));return _isSwapInWithClientToClient.apply(this,arguments);};","map":{"version":3,"sources":["/Users/USER/Desktop/MuunganoMoney/src/Pin/Fc/Blocked/Input.js"],"names":["React","Media","useForm","useNavigate","doc","getDocs","collection","getDoc","updateDoc","increment","db","phoneX","sendPhone","frais","Unite","solde","money","Button","Dialog","DialogActions","DialogContent","DialogTitle","DialogContentText","moment","prixHash","hashTrue","ReturnInput","small","medium","large","matches","SreenLarge","ScreenSmall","FormInput","pushDocs","Array","verifierSend","verifierGet","navigation","register","handleSubmit","reset","useState","pin","setPin","state","setState","first","setFirst","last","setLast","getstate","setGetstate","getfirst","setGetFirst","getlast","setGetLast","open","setOpen","fullWidth","setFullWidth","maxWidth","setMaxWidth","handleClickOpen","handleClose","useEffect","querySnapshot","forEach","push","id","some","value","sendRef","sendSnap","exists","data","code","firstname","lastname","getRef","getSnap","onSubmit","length","sendUser","toLowerCase","getUser","console","log","swapInWithDocsAgent","isSwapInWithClientToClient","swapInWithDocsAgentToClient","isSwapInWithClientToAgent","required","getPhone","prix","unite","cdf","user","phoneclient","delay","format","thriftcdf","Math","floor","Number","adminRef"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Input.css';\nimport Media from 'react-media';\nimport { useForm } from 'react-hook-form';\nimport { useNavigate } from 'react-router-dom';\nimport { doc, getDocs, collection, getDoc, updateDoc, increment } from \"firebase/firestore\";\nimport { db } from '../../../firebase';\n\nimport { phoneX } from '../../../Sign/Input';\nimport { sendPhone } from '../../../ValidExFran/Input';\nimport { frais, Unite, solde, money } from '../../../FC/Input';\n\nimport Button from '@mui/material/Button';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContentText from '@mui/material/DialogContentText';\n\nimport moment from 'moment';\n\nexport let prixHash = 0;\nexport let hashTrue = true;\n\n// Input Field Component \nexport default function ReturnInput() {\n return (\n  <Media\n   queries={{\n    small: '(max-width: 599px)',\n    medium: '(min-width: 600px) and (max-width:1199px)',\n    large: '(min-width: 1200px)',\n   }}>\n   {matches => (\n    <>\n     {matches.small && <ScreenSmall />}\n     {matches.medium && <SreenLarge />}\n     {matches.large && <SreenLarge />}\n    </>\n   )}\n  </Media>\n );\n};\nexport const SreenLarge = () => (\n <div className='wrp-input-phone-register'>\n  <FormInput />\n\n </div>\n);\nexport const ScreenSmall = () => (\n <div className='wrp-input-phone-register-sm'>\n  <FormInput />\n </div>\n);\n\nexport const FormInput = () => {\n\n let pushDocs = new Array();\n let verifierSend;\n let verifierGet;\n\n const navigation = useNavigate();\n const { register, handleSubmit, reset } = useForm();\n\n // send React useState  \n const [pin, setPin] = React.useState(null);\n const [state, setState] = React.useState(null);\n const [first, setFirst] = React.useState('');\n const [last, setLast] = React.useState('');\n\n // getting React useState\n const [getstate, setGetstate] = React.useState(null);\n const [getfirst, setGetFirst] = React.useState('');\n const [getlast, setGetLast] = React.useState('');\n\n\n const [open, setOpen] = React.useState(false);\n const [fullWidth, setFullWidth] = React.useState(true);\n const [maxWidth, setMaxWidth] = React.useState('sm');\n\n const handleClickOpen = () => {\n  setOpen(true);\n };\n const handleClose = () => {\n  setOpen(false);\n };\n\n\n React.useEffect(async () => {\n\n  const querySnapshot = await getDocs(collection(db, \"client\"));\n  querySnapshot.forEach((doc) => {\n   pushDocs.push(doc.id);\n  });\n\n  verifierSend = pushDocs.some(value => value == phoneX);\n  verifierGet = pushDocs.some(value => value == sendPhone);\n\n  const sendRef = doc(db, verifierSend ? \"client\" : \"agent\", phoneX);\n  const sendSnap = await getDoc(sendRef);\n\n  if (sendSnap.exists()) {\n   setPin(sendSnap.data().code);\n   setState(sendSnap.data().state);\n   setFirst(sendSnap.data().firstname);\n   setLast(sendSnap.data().lastname);\n  };\n\n  const getRef = doc(db, verifierGet ? \"client\" : \"agent\", sendPhone);\n  const getSnap = await getDoc(getRef);\n\n  if (getSnap.exists()) {\n   setGetstate(getSnap.data().state);\n   setGetFirst(getSnap.data().firstname);\n   setGetLast(getSnap.data().lastname);\n  };\n\n }, []);\n\n const onSubmit = async (data) => {\n\n  // Checked if value code is length valid\n  if (data.code.length != 6 || pin != data.code) {\n   setOpen(true);\n   reset();\n  } else {\n\n   const sendUser = first.toLowerCase() + ' ' + last.toLowerCase();\n   const getUser = getfirst.toLowerCase() + ' ' + getlast.toLowerCase();\n\n\n   if (state == \"agent\" && getstate == \"agent\") {\n\n    hashTrue = false;\n    prixHash = solde;\n\n    console.log('agent');\n    swapInWithDocsAgent(phoneX, sendPhone, sendUser, getUser, solde, Unite);\n    navigation('/send-success-blocked');\n\n   } else if (state == \"client\" && getstate == \"client\") {\n\n    hashTrue = true;\n    prixHash = money;\n\n    isSwapInWithClientToClient(phoneX, sendPhone, sendUser, getUser, solde, money, Unite);\n    navigation('/send-success-blocked');\n\n   } else {\n\n    if (state == \"agent\") {\n\n     hashTrue = false;\n     prixHash = solde;\n\n     console.log('agent');\n     swapInWithDocsAgentToClient(phoneX, sendPhone, sendUser, getUser, solde, Unite);\n     navigation('/send-success-blocked');\n\n    } else {\n\n     hashTrue = true;\n     prixHash = money;\n\n     isSwapInWithClientToAgent(phoneX, sendPhone, sendUser, getUser, solde, money, Unite);\n     console.log('other');\n     navigation('/send-success-blocked');\n\n    }\n\n   }\n\n  }\n };\n\n return (\n  <form onSubmit={handleSubmit(onSubmit)}>\n   <input type='password'\n    placeholder='Code'\n    name='code' {...register('code', { required: true })}\n   />\n\n   <Dialog\n    fullWidth={fullWidth}\n    maxWidth={maxWidth}\n    open={open}\n    onClose={handleClose}\n   >\n    <DialogTitle>MuunganoMoney</DialogTitle>\n    <DialogContent>\n\n     <DialogContentText>\n      Code d'accès refusé. Veuillez vérifier\n     </DialogContentText>\n\n    </DialogContent>\n    <DialogActions>\n     <Button onClick={handleClose}>Fermer</Button>\n    </DialogActions>\n   </Dialog>\n\n\n   <button className='Btn'>Valider</button>\n  </form>\n )\n};\n\n\nasync function swapInWithDocsAgent(sendPhone, getPhone, sendUser, getUser, prix, unite) {\n\n const sendRef = doc(db, \"agent\", sendPhone);\n await updateDoc(sendRef, {\n  cdf: increment(-(prix)),\n  money: prix,\n  user: getUser,\n  unite: unite,\n  phoneclient: getPhone,\n  delay: moment().format()\n });\n\n const getRef = doc(db, \"agent\", getPhone);\n await updateDoc(getRef, {\n  thriftcdf: increment(prix),\n  money: prix,\n  user: sendUser,\n  unite: unite,\n  phoneclient: sendPhone,\n  delay: moment().format()\n });\n\n};\nasync function swapInWithDocsAgentToClient(sendPhone, getPhone, sendUser, getUser, prix, unite) {\n\n const sendRef = doc(db, \"agent\", sendPhone);\n await updateDoc(sendRef, {\n  cdf: increment(-(prix)),\n  money: prix,\n  user: getUser,\n  unite: unite,\n  phoneclient: getPhone,\n  delay: moment().format()\n });\n\n const getRef = doc(db, \"client\", getPhone);\n await updateDoc(getRef, {\n  thriftcdf: increment(prix),\n  money: prix,\n  user: sendUser,\n  unite: unite,\n  phoneclient: sendPhone,\n  delay: moment().format()\n });\n\n};\nasync function isSwapInWithClientToAgent(sendPhone, getPhone, sendUser, getUser, prix, money, unite) {\n\n const sendRef = doc(db, \"client\", sendPhone);\n await updateDoc(sendRef, {\n  cdf: increment(-(prix)),\n  money: money,\n  user: getUser,\n  unite: unite,\n  phoneclient: getPhone,\n  delay: moment().format()\n });\n\n const getRef = doc(db, \"agent\", getPhone);\n await updateDoc(getRef, {\n  thriftcdf: increment(money),\n  money: money,\n  user: sendUser,\n  unite: unite,\n  thriftcdf: increment(Math.floor(Number(frais * 30 / 100))),\n  phoneclient: sendPhone,\n  delay: moment().format()\n });\n\n const adminRef = doc(db, \"muunganomoney\", \"money\");\n await updateDoc(adminRef, {\n  cdf: increment(Math.floor(Number(frais * 70 / 100)))\n });\n\n};\nasync function isSwapInWithClientToClient(sendPhone, getPhone, sendUser, getUser, prix, money, unite) {\n\n const sendRef = doc(db, \"client\", sendPhone);\n await updateDoc(sendRef, {\n  cdf: increment(-(prix)),\n  money: money,\n  user: getUser,\n  unite: unite,\n  phoneclient: getPhone,\n  delay: moment().format()\n });\n\n const getRef = doc(db, \"client\", getPhone);\n await updateDoc(getRef, {\n  thriftcdf: increment(money),\n  money: money,\n  user: sendUser,\n  unite: unite,\n  phoneclient: sendPhone,\n  delay: moment().format()\n });\n\n const adminRef = doc(db, \"muunganomoney\", \"money\");\n await updateDoc(adminRef, {\n  cdf: increment(Math.floor(Number(frais)))\n });\n\n};\n"]},"metadata":{},"sourceType":"module"}