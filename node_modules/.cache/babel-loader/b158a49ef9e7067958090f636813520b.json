{"ast":null,"code":"import _objectSpread from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/USER/Desktop/MuunganoMoney/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import'./Input.css';import Media from'react-media';import{useForm}from'react-hook-form';import{useNavigate}from'react-router-dom';import{doc,getDocs,collection,updateDoc,increment,onSnapshot}from\"firebase/firestore\";import{db}from'../../../firebase';import{phoneX}from'../../../Sign/Input';import{sendPhone}from'../../../ValidExUsd/Input';import{frais,Unite,solde,money}from'../../../USD/Input';import Button from'@mui/material/Button';import Dialog from'@mui/material/Dialog';import DialogActions from'@mui/material/DialogActions';import DialogContent from'@mui/material/DialogContent';import DialogTitle from'@mui/material/DialogTitle';import DialogContentText from'@mui/material/DialogContentText';import moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var prixHash=0;export var hashTrue=true;// Input Field Component \nexport default function ReturnInput(){return/*#__PURE__*/_jsx(Media,{queries:{small:'(max-width: 599px)',medium:'(min-width: 600px) and (max-width:1199px)',large:'(min-width: 1200px)'},children:function children(matches){return/*#__PURE__*/_jsxs(_Fragment,{children:[matches.small&&/*#__PURE__*/_jsx(ScreenSmall,{}),matches.medium&&/*#__PURE__*/_jsx(SreenLarge,{}),matches.large&&/*#__PURE__*/_jsx(SreenLarge,{})]});}});};export var SreenLarge=function SreenLarge(){return/*#__PURE__*/_jsx(\"div\",{className:\"wrp-input-phone-register\",children:/*#__PURE__*/_jsx(FormInput,{})});};export var ScreenSmall=function ScreenSmall(){return/*#__PURE__*/_jsx(\"div\",{className:\"wrp-input-phone-register-sm\",children:/*#__PURE__*/_jsx(FormInput,{})});};export var FormInput=function FormInput(){var pushDocs=new Array();var verifierSend;var verifierGet;var navigation=useNavigate();var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,reset=_useForm.reset;// send React useState  \nvar _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),pin=_React$useState2[0],setPin=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),state=_React$useState4[0],setState=_React$useState4[1];var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),first=_React$useState6[0],setFirst=_React$useState6[1];var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),last=_React$useState8[0],setLast=_React$useState8[1];// getting React useState\nvar _React$useState9=React.useState(null),_React$useState10=_slicedToArray(_React$useState9,2),getstate=_React$useState10[0],setGetstate=_React$useState10[1];var _React$useState11=React.useState(''),_React$useState12=_slicedToArray(_React$useState11,2),getfirst=_React$useState12[0],setGetFirst=_React$useState12[1];var _React$useState13=React.useState(''),_React$useState14=_slicedToArray(_React$useState13,2),getlast=_React$useState14[0],setGetLast=_React$useState14[1];var _React$useState15=React.useState(false),_React$useState16=_slicedToArray(_React$useState15,2),open=_React$useState16[0],setOpen=_React$useState16[1];var _React$useState17=React.useState(true),_React$useState18=_slicedToArray(_React$useState17,2),fullWidth=_React$useState18[0],setFullWidth=_React$useState18[1];var _React$useState19=React.useState('sm'),_React$useState20=_slicedToArray(_React$useState19,2),maxWidth=_React$useState20[0],setMaxWidth=_React$useState20[1];var handleClickOpen=function handleClickOpen(){setOpen(true);};var handleClose=function handleClose(){setOpen(false);};React.useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var querySnapshot,sendunsub,getunsub;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getDocs(collection(db,\"client\"));case 2:querySnapshot=_context.sent;querySnapshot.forEach(function(doc){pushDocs.push(doc.id);});verifierSend=pushDocs.some(function(value){return value==phoneX;});verifierGet=pushDocs.some(function(value){return value==sendPhone;});sendunsub=onSnapshot(doc(db,verifierSend?\"client\":\"agent\",phoneX),function(doc){setPin(doc.data().code);setState(doc.data().state);setFirst(doc.data().firstname);setLast(doc.data().lastname);});getunsub=onSnapshot(doc(db,verifierGet?\"client\":\"agent\",sendPhone),function(doc){setGetstate(doc.data().state);setGetFirst(doc.data().firstname);setGetLast(doc.data().lastname);});case 8:case\"end\":return _context.stop();}}},_callee);})),[]);var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var sendUser,getUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// Checked if value code is length valid\nif(data.code.length!=6||pin!=data.code){setOpen(true);reset();}else{sendUser=first.toLowerCase()+' '+last.toLowerCase();getUser=getfirst.toLowerCase()+' '+getlast.toLowerCase();if(state==\"agent\"&&getstate==\"agent\"){hashTrue=false;prixHash=solde;swapInWithDocsAgent(phoneX,sendPhone,sendUser,getUser,solde,Unite);navigation('/send-success-usd');}else if(state==\"client\"&&getstate==\"client\"){hashTrue=true;prixHash=money;isSwapInWithClientToClient(phoneX,sendPhone,sendUser,getUser,solde,money,Unite);navigation('/send-success-usd');}else{if(state==\"agent\"){hashTrue=false;prixHash=solde;console.log('agent');swapInWithDocsAgentToClient(phoneX,sendPhone,sendUser,getUser,solde,Unite);navigation('/send-success-usd');}else{hashTrue=true;prixHash=money;isSwapInWithClientToAgent(phoneX,sendPhone,sendUser,getUser,solde,money,Unite);console.log('other');navigation('/send-success-usd');}}}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"password\",placeholder:\"Code\",name:\"code\"},register('code',{required:true}))),/*#__PURE__*/_jsxs(Dialog,{fullWidth:fullWidth,maxWidth:maxWidth,open:open,onClose:handleClose,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"MuunganoMoney\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(DialogContentText,{children:\"Code d'erreur (PIN) Acc\\xE8s non valide\"})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:handleClose,children:\"Fermer\"})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"Btn\",children:\"Valider\"})]});};function swapInWithDocsAgent(_x2,_x3,_x4,_x5,_x6,_x7){return _swapInWithDocsAgent.apply(this,arguments);}function _swapInWithDocsAgent(){_swapInWithDocsAgent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(sendPhone,getPhone,sendUser,getUser,prix,unite){var sendRef,getRef;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:sendRef=doc(db,\"agent\",sendPhone);_context3.next=3;return updateDoc(sendRef,{usd:increment(-prix),money:prix,user:getUser,unite:unite,phoneclient:getPhone,delay:moment().format()});case 3:getRef=doc(db,\"agent\",getPhone);_context3.next=6;return updateDoc(getRef,{usd:increment(prix),money:prix,user:sendUser,unite:unite,phoneclient:sendPhone,delay:moment().format()});case 6:case\"end\":return _context3.stop();}}},_callee3);}));return _swapInWithDocsAgent.apply(this,arguments);};function swapInWithDocsAgentToClient(_x8,_x9,_x10,_x11,_x12,_x13){return _swapInWithDocsAgentToClient.apply(this,arguments);}function _swapInWithDocsAgentToClient(){_swapInWithDocsAgentToClient=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(sendPhone,getPhone,sendUser,getUser,prix,unite){var sendRef,getRef;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:sendRef=doc(db,\"agent\",sendPhone);_context4.next=3;return updateDoc(sendRef,{usd:increment(-prix),money:prix,user:getUser,unite:unite,phoneclient:getPhone,delay:moment().format()});case 3:getRef=doc(db,\"client\",getPhone);_context4.next=6;return updateDoc(getRef,{usd:increment(prix),money:prix,user:sendUser,unite:unite,phoneclient:sendPhone,delay:moment().format()});case 6:case\"end\":return _context4.stop();}}},_callee4);}));return _swapInWithDocsAgentToClient.apply(this,arguments);};function isSwapInWithClientToAgent(_x14,_x15,_x16,_x17,_x18,_x19,_x20){return _isSwapInWithClientToAgent.apply(this,arguments);}function _isSwapInWithClientToAgent(){_isSwapInWithClientToAgent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(sendPhone,getPhone,sendUser,getUser,prix,money,unite){var sendRef,getRef,adminRef;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:sendRef=doc(db,\"client\",sendPhone);_context5.next=3;return updateDoc(sendRef,{usd:increment(-prix),money:money,user:getUser,unite:unite,phoneclient:getPhone,delay:moment().format()});case 3:getRef=doc(db,\"agent\",getPhone);_context5.next=6;return updateDoc(getRef,{usd:increment(money),money:money,user:sendUser,unite:unite,thriftusd:increment(Number(frais*30/100)),phoneclient:sendPhone,delay:moment().format()});case 6:adminRef=doc(db,\"muunganomoney\",\"money\");_context5.next=9;return updateDoc(adminRef,{usd:increment(Number(frais*70/100))});case 9:case\"end\":return _context5.stop();}}},_callee5);}));return _isSwapInWithClientToAgent.apply(this,arguments);};function isSwapInWithClientToClient(_x21,_x22,_x23,_x24,_x25,_x26,_x27){return _isSwapInWithClientToClient.apply(this,arguments);}function _isSwapInWithClientToClient(){_isSwapInWithClientToClient=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(sendPhone,getPhone,sendUser,getUser,prix,money,unite){var sendRef,getRef,adminRef;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:sendRef=doc(db,\"client\",sendPhone);_context6.next=3;return updateDoc(sendRef,{usd:increment(-prix),money:money,user:getUser,unite:unite,phoneclient:getPhone,delay:moment().format()});case 3:getRef=doc(db,\"client\",getPhone);_context6.next=6;return updateDoc(getRef,{usd:increment(money),money:money,user:sendUser,unite:unite,phoneclient:sendPhone,delay:moment().format()});case 6:adminRef=doc(db,\"muunganomoney\",\"money\");_context6.next=9;return updateDoc(adminRef,{usd:increment(Math.floor(Number(frais)))});case 9:case\"end\":return _context6.stop();}}},_callee6);}));return _isSwapInWithClientToClient.apply(this,arguments);};","map":{"version":3,"sources":["/Users/USER/Desktop/MuunganoMoney/src/Pin/Usd/Simple/Input.js"],"names":["React","Media","useForm","useNavigate","doc","getDocs","collection","updateDoc","increment","onSnapshot","db","phoneX","sendPhone","frais","Unite","solde","money","Button","Dialog","DialogActions","DialogContent","DialogTitle","DialogContentText","moment","prixHash","hashTrue","ReturnInput","small","medium","large","matches","SreenLarge","ScreenSmall","FormInput","pushDocs","Array","verifierSend","verifierGet","navigation","register","handleSubmit","reset","useState","pin","setPin","state","setState","first","setFirst","last","setLast","getstate","setGetstate","getfirst","setGetFirst","getlast","setGetLast","open","setOpen","fullWidth","setFullWidth","maxWidth","setMaxWidth","handleClickOpen","handleClose","useEffect","querySnapshot","forEach","push","id","some","value","sendunsub","data","code","firstname","lastname","getunsub","onSubmit","length","sendUser","toLowerCase","getUser","swapInWithDocsAgent","isSwapInWithClientToClient","console","log","swapInWithDocsAgentToClient","isSwapInWithClientToAgent","required","getPhone","prix","unite","sendRef","usd","user","phoneclient","delay","format","getRef","thriftusd","Number","adminRef","Math","floor"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Input.css';\nimport Media from 'react-media';\nimport { useForm } from 'react-hook-form';\nimport { useNavigate } from 'react-router-dom';\nimport { doc, getDocs, collection, updateDoc, increment, onSnapshot } from \"firebase/firestore\";\nimport { db } from '../../../firebase';\n\nimport { phoneX } from '../../../Sign/Input';\nimport { sendPhone } from '../../../ValidExUsd/Input';\nimport { frais, Unite, solde, money } from '../../../USD/Input';\n\nimport Button from '@mui/material/Button';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContentText from '@mui/material/DialogContentText';\n\nimport moment from 'moment';\n\n\nexport let prixHash = 0;\nexport let hashTrue = true;\n\n// Input Field Component \nexport default function ReturnInput() {\n return (\n  <Media\n   queries={{\n    small: '(max-width: 599px)',\n    medium: '(min-width: 600px) and (max-width:1199px)',\n    large: '(min-width: 1200px)',\n   }}>\n   {matches => (\n    <>\n     {matches.small && <ScreenSmall />}\n     {matches.medium && <SreenLarge />}\n     {matches.large && <SreenLarge />}\n    </>\n   )}\n  </Media>\n );\n};\n\nexport const SreenLarge = () => (\n <div className='wrp-input-phone-register'>\n  <FormInput />\n\n </div>\n);\nexport const ScreenSmall = () => (\n <div className='wrp-input-phone-register-sm'>\n  <FormInput />\n </div>\n);\nexport const FormInput = () => {\n\n let pushDocs = new Array();\n let verifierSend;\n let verifierGet;\n\n const navigation = useNavigate();\n const { register, handleSubmit, reset } = useForm();\n\n // send React useState  \n const [pin, setPin] = React.useState(null);\n const [state, setState] = React.useState(null);\n const [first, setFirst] = React.useState('');\n const [last, setLast] = React.useState('');\n\n // getting React useState\n const [getstate, setGetstate] = React.useState(null);\n const [getfirst, setGetFirst] = React.useState('');\n const [getlast, setGetLast] = React.useState('');\n\n\n const [open, setOpen] = React.useState(false);\n const [fullWidth, setFullWidth] = React.useState(true);\n const [maxWidth, setMaxWidth] = React.useState('sm');\n\n const handleClickOpen = () => {\n  setOpen(true);\n };\n const handleClose = () => {\n  setOpen(false);\n };\n\n React.useEffect(async () => {\n\n  const querySnapshot = await getDocs(collection(db, \"client\"));\n  querySnapshot.forEach((doc) => {\n   pushDocs.push(doc.id);\n  });\n\n  verifierSend = pushDocs.some(value => value == phoneX);\n  verifierGet = pushDocs.some(value => value == sendPhone);\n\n  const sendunsub = onSnapshot(doc(db, verifierSend ? \"client\" : \"agent\", phoneX), (doc) => {\n   setPin(doc.data().code);\n   setState(doc.data().state);\n   setFirst(doc.data().firstname);\n   setLast(doc.data().lastname);\n  });\n  const getunsub = onSnapshot(doc(db, verifierGet ? \"client\" : \"agent\", sendPhone), (doc) => {\n   setGetstate(doc.data().state);\n   setGetFirst(doc.data().firstname);\n   setGetLast(doc.data().lastname);\n  });\n\n }, []);\n\n const onSubmit = async (data) => {\n\n  // Checked if value code is length valid\n  if (data.code.length != 6 || pin != data.code) {\n   setOpen(true);\n   reset();\n\n  } else {\n   const sendUser = first.toLowerCase() + ' ' + last.toLowerCase();\n   const getUser = getfirst.toLowerCase() + ' ' + getlast.toLowerCase();\n\n   if (state == \"agent\" && getstate == \"agent\") {\n\n    hashTrue = false;\n    prixHash = solde;\n    swapInWithDocsAgent(phoneX, sendPhone, sendUser, getUser, solde, Unite);\n    navigation('/send-success-usd');\n\n   } else if (state == \"client\" && getstate == \"client\") {\n\n    hashTrue = true;\n    prixHash = money;\n    isSwapInWithClientToClient(phoneX, sendPhone, sendUser, getUser, solde, money, Unite);\n    navigation('/send-success-usd');\n\n   } else {\n\n    if (state == \"agent\") {\n\n     hashTrue = false;\n     prixHash = solde;\n     console.log('agent');\n     swapInWithDocsAgentToClient(phoneX, sendPhone, sendUser, getUser, solde, Unite);\n     navigation('/send-success-usd');\n\n    } else {\n\n     hashTrue = true;\n     prixHash = money;\n\n     isSwapInWithClientToAgent(phoneX, sendPhone, sendUser, getUser, solde, money, Unite);\n\n     console.log('other');\n     navigation('/send-success-usd');\n\n    }\n\n   }\n\n  }\n };\n\n\n return (\n  <form onSubmit={handleSubmit(onSubmit)}>\n   <input type='password'\n    placeholder='Code'\n    name='code' {...register('code', { required: true })}\n   />\n\n   <Dialog\n    fullWidth={fullWidth}\n    maxWidth={maxWidth}\n    open={open}\n    onClose={handleClose}\n   >\n    <DialogTitle>MuunganoMoney</DialogTitle>\n    <DialogContent>\n\n     <DialogContentText>\n      Code d'erreur (PIN) Acc√®s non valide\n     </DialogContentText>\n\n    </DialogContent>\n    <DialogActions>\n     <Button onClick={handleClose}>Fermer</Button>\n    </DialogActions>\n   </Dialog>\n\n\n   <button className='Btn'>Valider</button>\n  </form>\n )\n};\n\nasync function swapInWithDocsAgent(sendPhone, getPhone, sendUser, getUser, prix, unite) {\n\n const sendRef = doc(db, \"agent\", sendPhone);\n await updateDoc(sendRef, {\n  usd: increment(-(prix)),\n  money: prix,\n  user: getUser,\n  unite: unite,\n  phoneclient: getPhone,\n  delay: moment().format()\n });\n\n const getRef = doc(db, \"agent\", getPhone);\n await updateDoc(getRef, {\n  usd: increment(prix),\n  money: prix,\n  user: sendUser,\n  unite: unite,\n  phoneclient: sendPhone,\n  delay: moment().format()\n });\n\n};\nasync function swapInWithDocsAgentToClient(sendPhone, getPhone, sendUser, getUser, prix, unite) {\n\n const sendRef = doc(db, \"agent\", sendPhone);\n await updateDoc(sendRef, {\n  usd: increment(-(prix)),\n  money: prix,\n  user: getUser,\n  unite: unite,\n  phoneclient: getPhone,\n  delay: moment().format()\n });\n\n const getRef = doc(db, \"client\", getPhone);\n await updateDoc(getRef, {\n  usd: increment(prix),\n  money: prix,\n  user: sendUser,\n  unite: unite,\n  phoneclient: sendPhone,\n  delay: moment().format()\n });\n\n};\nasync function isSwapInWithClientToAgent(sendPhone, getPhone, sendUser, getUser, prix, money, unite) {\n\n const sendRef = doc(db, \"client\", sendPhone);\n await updateDoc(sendRef, {\n  usd: increment(-(prix)),\n  money: money,\n  user: getUser,\n  unite: unite,\n  phoneclient: getPhone,\n  delay: moment().format()\n });\n\n const getRef = doc(db, \"agent\", getPhone);\n await updateDoc(getRef, {\n  usd: increment(money),\n  money: money,\n  user: sendUser,\n  unite: unite,\n  thriftusd: increment((Number(frais * 30 / 100))),\n  phoneclient: sendPhone,\n  delay: moment().format()\n });\n\n const adminRef = doc(db, \"muunganomoney\", \"money\");\n await updateDoc(adminRef, {\n  usd: increment((Number(frais * 70 / 100)))\n });\n\n};\nasync function isSwapInWithClientToClient(sendPhone, getPhone, sendUser, getUser, prix, money, unite) {\n\n const sendRef = doc(db, \"client\", sendPhone);\n await updateDoc(sendRef, {\n  usd: increment(-(prix)),\n  money: money,\n  user: getUser,\n  unite: unite,\n  phoneclient: getPhone,\n  delay: moment().format()\n });\n\n const getRef = doc(db, \"client\", getPhone);\n await updateDoc(getRef, {\n  usd: increment(money),\n  money: money,\n  user: sendUser,\n  unite: unite,\n  phoneclient: sendPhone,\n  delay: moment().format()\n });\n\n const adminRef = doc(db, \"muunganomoney\", \"money\");\n await updateDoc(adminRef, {\n  usd: increment(Math.floor(Number(frais)))\n });\n\n};\n"]},"metadata":{},"sourceType":"module"}