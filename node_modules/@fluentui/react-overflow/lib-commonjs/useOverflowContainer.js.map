{"version":3,"names":["React","require","priority_overflow_1","react_utilities_1","constants_1","useOverflowContainer","update","options","overflowAxis","overflowDirection","padding","minimumVisible","onUpdateItemVisibility","containerRef","useRef","updateOverflowItems","useEventCallback","overflowManager","useState","canUseDOM","createOverflowManager","useIsomorphicLayoutEffect","current","observe","undefined","onUpdateOverflow","disconnect","registerItem","useCallback","item","addItem","element","setAttribute","DATA_OVERFLOW_ITEM","removeAttribute","DATA_OVERFLOWING","removeItem","id","updateOverflow","registerOverflowMenu","el","addOverflowMenu","DATA_OVERFLOW_MENU","removeOverflowMenu","exports","updateVisibilityAttribute","visible"],"sources":["../src/packages/react-components/react-overflow/src/useOverflowContainer.ts"],"sourcesContent":["import * as React from 'react';\nimport { createOverflowManager } from '@fluentui/priority-overflow';\n\n/**\n * @internal\n */\nimport type {\n  OnUpdateItemVisibility,\n  OnUpdateOverflow,\n  OverflowItemEntry,\n  OverflowManager,\n  ObserveOptions,\n} from '@fluentui/priority-overflow';\nimport { canUseDOM, useEventCallback, useIsomorphicLayoutEffect } from '@fluentui/react-utilities';\nimport { UseOverflowContainerReturn } from './types';\nimport { DATA_OVERFLOWING, DATA_OVERFLOW_ITEM, DATA_OVERFLOW_MENU } from './constants';\n\n/**\n * @internal\n * @param update - Callback when overflow state changes\n * @param options - Options to configure the overflow container\n * @returns - ref to attach to an intrinsic HTML element and imperative functions\n */\nexport const useOverflowContainer = <TElement extends HTMLElement>(\n  update: OnUpdateOverflow,\n  options: Omit<ObserveOptions, 'onUpdateOverflow'>,\n): UseOverflowContainerReturn<TElement> => {\n  const { overflowAxis, overflowDirection, padding, minimumVisible, onUpdateItemVisibility } = options;\n\n  // DOM ref to the overflow container element\n  const containerRef = React.useRef<TElement>(null);\n  const updateOverflowItems = useEventCallback(update);\n\n  const [overflowManager] = React.useState<OverflowManager | null>(() =>\n    canUseDOM() ? createOverflowManager() : null,\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    if (!containerRef.current) {\n      return;\n    }\n\n    if (overflowManager) {\n      overflowManager.observe(containerRef.current, {\n        overflowDirection: overflowDirection ?? 'end',\n        overflowAxis: overflowAxis ?? 'horizontal',\n        padding: padding ?? 10,\n        minimumVisible: minimumVisible ?? 0,\n        onUpdateItemVisibility: onUpdateItemVisibility ?? (() => undefined),\n        onUpdateOverflow: updateOverflowItems ?? (() => undefined),\n      });\n\n      return () => {\n        overflowManager.disconnect();\n      };\n    }\n  }, [\n    updateOverflowItems,\n    overflowManager,\n    overflowDirection,\n    overflowAxis,\n    padding,\n    minimumVisible,\n    onUpdateItemVisibility,\n  ]);\n\n  const registerItem = React.useCallback(\n    (item: OverflowItemEntry) => {\n      overflowManager?.addItem(item);\n      item.element.setAttribute(DATA_OVERFLOW_ITEM, '');\n\n      return () => {\n        item.element.removeAttribute(DATA_OVERFLOWING);\n        item.element.removeAttribute(DATA_OVERFLOW_ITEM);\n        overflowManager?.removeItem(item.id);\n      };\n    },\n    [overflowManager],\n  );\n\n  const updateOverflow = React.useCallback(() => {\n    overflowManager?.update();\n  }, [overflowManager]);\n\n  const registerOverflowMenu = React.useCallback(\n    (el: HTMLElement) => {\n      overflowManager?.addOverflowMenu(el);\n      el.setAttribute(DATA_OVERFLOW_MENU, '');\n\n      return () => {\n        overflowManager?.removeOverflowMenu();\n        el.removeAttribute(DATA_OVERFLOW_MENU);\n      };\n    },\n    [overflowManager],\n  );\n\n  return {\n    containerRef,\n    registerItem,\n    updateOverflow,\n    registerOverflowMenu,\n  };\n};\n\nexport const updateVisibilityAttribute: OnUpdateItemVisibility = ({ item, visible }) => {\n  if (visible) {\n    item.element.removeAttribute(DATA_OVERFLOWING);\n  } else {\n    item.element.setAttribute(DATA_OVERFLOWING, '');\n  }\n};\n"],"mappings":"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"}