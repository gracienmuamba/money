{"version":3,"names":["react_utilities_1","require","react_tabster_1","popoverContext_1","react_aria_1","keyboard_keys_1","usePopoverTrigger_unstable","props","children","disableButtonEnhancement","child","getTriggerChild","open","usePopoverContext_unstable","context","setOpen","toggleOpen","triggerRef","openOnHover","openOnContext","triggerAttributes","useModalAttributes","onContextMenu","e","preventDefault","onClick","onKeyDown","key","Escape","stopPropagation","onMouseEnter","onMouseLeave","contextMenuProps","useEventCallback","mergeCallbacks","ref","useMergedRefs","triggerChildProps","ariaButtonTriggerChildProps","useARIAButtonProps","type","applyTriggerPropsToChildren","exports"],"sources":["../src/packages/react-components/react-popover/src/components/PopoverTrigger/usePopoverTrigger.ts"],"sourcesContent":["import * as React from 'react';\nimport {\n  applyTriggerPropsToChildren,\n  getTriggerChild,\n  mergeCallbacks,\n  useMergedRefs,\n  useEventCallback,\n} from '@fluentui/react-utilities';\nimport { useModalAttributes } from '@fluentui/react-tabster';\nimport { usePopoverContext_unstable } from '../../popoverContext';\nimport type { PopoverTriggerProps, PopoverTriggerState } from './PopoverTrigger.types';\nimport { useARIAButtonProps } from '@fluentui/react-aria';\nimport { Escape } from '@fluentui/keyboard-keys';\n\n/**\n * Create the state required to render PopoverTrigger.\n *\n * The returned state can be modified with hooks such as usePopoverTriggerStyles,\n * before being passed to renderPopoverTrigger_unstable.\n *\n * @param props - props from this instance of PopoverTrigger\n */\nexport const usePopoverTrigger_unstable = (props: PopoverTriggerProps): PopoverTriggerState => {\n  const { children, disableButtonEnhancement = false } = props;\n  const child = getTriggerChild(children);\n\n  const open = usePopoverContext_unstable(context => context.open);\n  const setOpen = usePopoverContext_unstable(context => context.setOpen);\n  const toggleOpen = usePopoverContext_unstable(context => context.toggleOpen);\n  const triggerRef = usePopoverContext_unstable(context => context.triggerRef);\n  const openOnHover = usePopoverContext_unstable(context => context.openOnHover);\n  const openOnContext = usePopoverContext_unstable(context => context.openOnContext);\n  const { triggerAttributes } = useModalAttributes();\n\n  const onContextMenu = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnContext) {\n      e.preventDefault();\n      setOpen(e, true);\n    }\n  };\n\n  const onClick = (e: React.MouseEvent<HTMLElement>) => {\n    if (!openOnContext) {\n      toggleOpen(e);\n    }\n  };\n\n  const onKeyDown = (e: React.KeyboardEvent<HTMLElement>) => {\n    if (e.key === Escape && open) {\n      setOpen(e, false);\n      // stop propagation to avoid conflicting with other elements that listen for `Escape`\n      // e,g: Dialog, Menu\n      e.stopPropagation();\n    }\n  };\n\n  const onMouseEnter = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnHover) {\n      setOpen(e, true);\n    }\n  };\n\n  const onMouseLeave = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnHover) {\n      setOpen(e, false);\n    }\n  };\n\n  const contextMenuProps = {\n    ...triggerAttributes,\n    'aria-expanded': `${open}`,\n    ...child?.props,\n    onMouseEnter: useEventCallback(mergeCallbacks(child?.props.onMouseEnter, onMouseEnter)),\n    onMouseLeave: useEventCallback(mergeCallbacks(child?.props.onMouseLeave, onMouseLeave)),\n    onContextMenu: useEventCallback(mergeCallbacks(child?.props.onContextMenu, onContextMenu)),\n    ref: useMergedRefs(triggerRef, child?.ref),\n  } as const;\n\n  const triggerChildProps = {\n    ...contextMenuProps,\n    onClick: useEventCallback(mergeCallbacks(child?.props.onClick, onClick)),\n    onKeyDown: useEventCallback(mergeCallbacks(child?.props.onKeyDown, onKeyDown)),\n  };\n\n  const ariaButtonTriggerChildProps = useARIAButtonProps(\n    child?.type === 'button' || child?.type === 'a' ? child.type : 'div',\n    triggerChildProps,\n  );\n\n  return {\n    children: applyTriggerPropsToChildren(\n      props.children,\n      useARIAButtonProps(\n        child?.type === 'button' || child?.type === 'a' ? child.type : 'div',\n        openOnContext ? contextMenuProps : disableButtonEnhancement ? triggerChildProps : ariaButtonTriggerChildProps,\n      ),\n    ),\n  };\n};\n"],"mappings":"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"}