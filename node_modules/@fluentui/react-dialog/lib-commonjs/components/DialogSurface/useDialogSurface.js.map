{"version":3,"names":["react_utilities_1","require","contexts_1","utils_1","react_tabster_1","useDialogSurface_unstable","props","ref","backdrop","as","modalType","useDialogContext_unstable","ctx","inertTrapFocus","dialogRef","open","requestOpenChange","dialogTitleID","dialogTitleId","handledBackdropClick","useEventCallback","event","isResolvedShorthand","_b","_a","onClick","call","isDefaultPrevented","type","handleKeyDown","onKeyDown","isEscapeKeyDismiss","stopPropagation","modalAttributes","useModalAttributes","trapFocus","legacyTrapFocus","components","root","resolveShorthand","required","defaultProps","getNativeElementProps","tabIndex","role","undefined","useMergedRefs","exports"],"sources":["../src/packages/react-components/react-dialog/src/components/DialogSurface/useDialogSurface.ts"],"sourcesContent":["import * as React from 'react';\nimport {\n  getNativeElementProps,\n  resolveShorthand,\n  useEventCallback,\n  useMergedRefs,\n  isResolvedShorthand,\n} from '@fluentui/react-utilities';\nimport type {\n  DialogSurfaceElement,\n  DialogSurfaceElementIntersection,\n  DialogSurfaceProps,\n  DialogSurfaceState,\n} from './DialogSurface.types';\nimport { useDialogContext_unstable } from '../../contexts';\nimport { isEscapeKeyDismiss } from '../../utils';\nimport { useModalAttributes } from '@fluentui/react-tabster';\n\n/**\n * Create the state required to render DialogSurface.\n *\n * The returned state can be modified with hooks such as useDialogSurfaceStyles_unstable,\n * before being passed to renderDialogSurface_unstable.\n *\n * @param props - props from this instance of DialogSurface\n * @param ref - reference to root HTMLElement of DialogSurface\n */\nexport const useDialogSurface_unstable = (\n  props: DialogSurfaceProps,\n  ref: React.Ref<DialogSurfaceElement>,\n): DialogSurfaceState => {\n  const { backdrop, as } = props;\n  const modalType = useDialogContext_unstable(ctx => ctx.modalType);\n  const inertTrapFocus = useDialogContext_unstable(ctx => ctx.inertTrapFocus);\n  const dialogRef = useDialogContext_unstable(ctx => ctx.dialogRef);\n  const open = useDialogContext_unstable(ctx => ctx.open);\n  const requestOpenChange = useDialogContext_unstable(ctx => ctx.requestOpenChange);\n  const dialogTitleID = useDialogContext_unstable(ctx => ctx.dialogTitleId);\n\n  const handledBackdropClick = useEventCallback((event: React.MouseEvent<HTMLDivElement>) => {\n    if (isResolvedShorthand(props.backdrop)) {\n      props.backdrop.onClick?.(event);\n    }\n    if (modalType === 'modal' && !event.isDefaultPrevented()) {\n      requestOpenChange({\n        event,\n        open: false,\n        type: 'backdropClick',\n      });\n    }\n  });\n\n  const handleKeyDown = useEventCallback((event: React.KeyboardEvent<DialogSurfaceElementIntersection>) => {\n    props.onKeyDown?.(event);\n\n    if (isEscapeKeyDismiss(event, modalType)) {\n      requestOpenChange({\n        event,\n        open: false,\n        type: 'escapeKeyDown',\n      });\n      // stop propagation to avoid conflicting with other elements that listen for `Escape`\n      // e,g: nested Dialog, Popover, Menu and Tooltip\n      event.stopPropagation();\n    }\n  });\n\n  const { modalAttributes } = useModalAttributes({\n    trapFocus: modalType !== 'non-modal',\n    legacyTrapFocus: !inertTrapFocus,\n  });\n\n  return {\n    components: {\n      backdrop: 'div',\n      root: 'div',\n    },\n    backdrop: resolveShorthand(backdrop, {\n      required: open && modalType !== 'non-modal',\n      defaultProps: {\n        'aria-hidden': 'true',\n        onClick: handledBackdropClick,\n      },\n    }),\n    root: getNativeElementProps(as ?? 'div', {\n      tabIndex: -1, // https://github.com/microsoft/fluentui/issues/25150\n      'aria-modal': modalType !== 'non-modal',\n      role: modalType === 'alert' ? 'alertdialog' : 'dialog',\n      'aria-labelledby': props['aria-label'] ? undefined : dialogTitleID,\n      ...props,\n      ...modalAttributes,\n      onKeyDown: handleKeyDown,\n      ref: useMergedRefs(ref, dialogRef),\n    }),\n  };\n};\n"],"mappings":"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"}