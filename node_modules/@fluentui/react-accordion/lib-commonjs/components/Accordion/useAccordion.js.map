{"version":3,"names":["React","require","react_utilities_1","react_tabster_1","useAccordion_unstable","props","ref","openItems","controlledOpenItems","defaultOpenItems","multiple","collapsible","onToggle","navigation","setOpenItems","useControllableState","state","useMemo","normalizeValues","defaultState","initializeUncontrolledOpenItems","initialState","arrowNavigationProps","useArrowNavigationGroup","circular","tabbable","requestToggle","useEventCallback","event","data","previousOpenItems","updateOpenItems","value","components","root","getNativeElementProps","exports","undefined","Array","isArray","includes","length","filter","i","sort","index"],"sources":["../src/packages/react-components/react-accordion/src/components/Accordion/useAccordion.ts"],"sourcesContent":["import * as React from 'react';\nimport { getNativeElementProps, useControllableState, useEventCallback } from '@fluentui/react-utilities';\nimport type { AccordionProps, AccordionState, AccordionToggleData, AccordionToggleEvent } from './Accordion.types';\nimport type { AccordionItemValue } from '../AccordionItem/AccordionItem.types';\nimport { useArrowNavigationGroup } from '@fluentui/react-tabster';\n\n/**\n * Returns the props and state required to render the component\n * @param props - Accordion properties\n * @param ref - reference to root HTMLElement of Accordion\n */\nexport const useAccordion_unstable = (props: AccordionProps, ref: React.Ref<HTMLElement>): AccordionState => {\n  const {\n    openItems: controlledOpenItems,\n    defaultOpenItems,\n    multiple = false,\n    collapsible = false,\n    onToggle,\n    navigation,\n  } = props;\n  const [openItems, setOpenItems] = useControllableState({\n    state: React.useMemo(() => normalizeValues(controlledOpenItems), [controlledOpenItems]),\n    defaultState: () => initializeUncontrolledOpenItems({ defaultOpenItems, multiple }),\n    initialState: [],\n  });\n\n  const arrowNavigationProps = useArrowNavigationGroup({\n    circular: navigation === 'circular',\n    tabbable: true,\n  });\n\n  const requestToggle = useEventCallback((event: AccordionToggleEvent, data: AccordionToggleData) => {\n    onToggle?.(event, data);\n    setOpenItems(previousOpenItems => updateOpenItems(data.value, previousOpenItems, multiple, collapsible));\n  });\n\n  return {\n    collapsible,\n    navigation,\n    openItems,\n    requestToggle,\n    components: {\n      root: 'div',\n    },\n    root: getNativeElementProps('div', {\n      ...props,\n      ...(navigation ? arrowNavigationProps : {}),\n      ref,\n    }),\n  };\n};\n\n/**\n * Initial value for the uncontrolled case of the list of open indexes\n */\nfunction initializeUncontrolledOpenItems({\n  defaultOpenItems,\n  multiple,\n}: Pick<AccordionProps, 'defaultOpenItems' | 'multiple'>): AccordionItemValue[] {\n  if (defaultOpenItems !== undefined) {\n    if (Array.isArray(defaultOpenItems)) {\n      return multiple ? defaultOpenItems : [defaultOpenItems[0]];\n    }\n    return [defaultOpenItems];\n  }\n  return [];\n}\n\n/**\n * Updates the list of open indexes based on an index that changes\n * @param value - the index that will change\n * @param previousOpenItems - list of current open indexes\n * @param multiple - if Accordion support multiple Panels opened at the same time\n * @param collapsible - if Accordion support multiple Panels closed at the same time\n */\nfunction updateOpenItems(\n  value: AccordionItemValue,\n  previousOpenItems: AccordionItemValue[],\n  multiple: boolean,\n  collapsible: boolean,\n) {\n  if (multiple) {\n    if (previousOpenItems.includes(value)) {\n      if (previousOpenItems.length > 1 || collapsible) {\n        return previousOpenItems.filter(i => i !== value);\n      }\n    } else {\n      return [...previousOpenItems, value].sort();\n    }\n  } else {\n    return previousOpenItems[0] === value && collapsible ? [] : [value];\n  }\n  return previousOpenItems;\n}\n\n/**\n * Normalizes Accordion index into an array of indexes\n */\nfunction normalizeValues(index?: AccordionItemValue | AccordionItemValue[]): AccordionItemValue[] | undefined {\n  if (index === undefined) {\n    return undefined;\n  }\n  return Array.isArray(index) ? index : [index];\n}\n"],"mappings":"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"}