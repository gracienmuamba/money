{"version":3,"names":["React","require","keyboard_keys_1","react_icons_1","react_utilities_1","dropdownKeyActions_1","useComboboxBaseState_1","useComboboxPopup_1","useTriggerListboxSlots_1","Listbox_1","useCombobox_unstable","props","ref","baseState","useComboboxBaseState","editable","activeOption","clearSelection","getIndexOfId","getOptionsMatchingText","hasFocus","open","selectOption","selectedOptions","setActiveOption","setFocusVisible","setOpen","setValue","value","disabled","freeform","inlinePopup","multiselect","comboId","useId","primary","triggerNativeProps","root","rootNativeProps","getPartitionedNativeProps","primarySlotTagName","excludedPropNames","rootRef","useRef","triggerRef","hideActiveDescendant","setHideActiveDescendant","useState","popupDimensions","setPopupDimensions","useEffect","width","_a","current","clientWidth","getOptionFromInput","inputValue","searchString","trim","toLowerCase","length","matcher","optionText","indexOf","matches","startIndex","id","nextMatch","find","option","undefined","ev","onTriggerBlur","text","newState","onTriggerChange","target","matchingOption","onTriggerKeyDown","getDropdownActionFromKey","key","ArrowLeft","ArrowRight","triggerSlot","listboxSlot","resolveShorthand","input","required","defaultProps","useMergedRefs","type","onChange","mergeCallbacks","onBlur","onKeyDown","listbox","children","style","useComboboxPopup","useTriggerListboxSlots","state","components","expandIcon","Listbox","createElement","ChevronDownRegular","role","onMouseDown","onIconMouseDown","onClick","onIconClick","onExpandIconMouseDown","useEventCallback","ignoreNextBlur","onExpandIconClick","event","focus","hasExpandLabel","defaultOpenString","chevronId","_b","chevronLabelledBy","exports"],"sources":["../src/packages/react-components/react-combobox/src/components/Combobox/useCombobox.tsx"],"sourcesContent":["import * as React from 'react';\nimport { ArrowLeft, ArrowRight } from '@fluentui/keyboard-keys';\nimport { ChevronDownRegular as ChevronDownIcon } from '@fluentui/react-icons';\nimport {\n  getPartitionedNativeProps,\n  resolveShorthand,\n  mergeCallbacks,\n  useEventCallback,\n  useId,\n  useMergedRefs,\n} from '@fluentui/react-utilities';\nimport { getDropdownActionFromKey } from '../../utils/dropdownKeyActions';\nimport { useComboboxBaseState } from '../../utils/useComboboxBaseState';\nimport { useComboboxPopup } from '../../utils/useComboboxPopup';\nimport { useTriggerListboxSlots } from '../../utils/useTriggerListboxSlots';\nimport { Listbox } from '../Listbox/Listbox';\nimport type { Slot } from '@fluentui/react-utilities';\nimport type { SelectionEvents } from '../../utils/Selection.types';\nimport type { OptionValue } from '../../utils/OptionCollection.types';\nimport type { ComboboxProps, ComboboxState } from './Combobox.types';\n\n/**\n * Create the state required to render Combobox.\n *\n * The returned state can be modified with hooks such as useComboboxStyles_unstable,\n * before being passed to renderCombobox_unstable.\n *\n * @param props - props from this instance of Combobox\n * @param ref - reference to root HTMLElement of Combobox\n */\nexport const useCombobox_unstable = (props: ComboboxProps, ref: React.Ref<HTMLInputElement>): ComboboxState => {\n  const baseState = useComboboxBaseState({ ...props, editable: true });\n  const {\n    activeOption,\n    clearSelection,\n    getIndexOfId,\n    getOptionsMatchingText,\n    hasFocus,\n    open,\n    selectOption,\n    selectedOptions,\n    setActiveOption,\n    setFocusVisible,\n    setOpen,\n    setValue,\n    value,\n  } = baseState;\n  const { disabled, freeform, inlinePopup, multiselect } = props;\n  const comboId = useId('combobox-');\n\n  const { primary: triggerNativeProps, root: rootNativeProps } = getPartitionedNativeProps({\n    props,\n    primarySlotTagName: 'input',\n    excludedPropNames: ['children', 'size'],\n  });\n\n  const rootRef = React.useRef<HTMLDivElement>(null);\n  const triggerRef = React.useRef<HTMLInputElement>(null);\n\n  // NVDA and JAWS have bugs that suppress reading the input value text when aria-activedescendant is set\n  // To prevent this, we clear the HTML attribute (but save the state) when a user presses left/right arrows\n  // ref: https://github.com/microsoft/fluentui/issues/26359#issuecomment-1397759888\n  const [hideActiveDescendant, setHideActiveDescendant] = React.useState(false);\n\n  // calculate listbox width style based on trigger width\n  const [popupDimensions, setPopupDimensions] = React.useState<{ width: string }>();\n  React.useEffect(() => {\n    // only recalculate width when opening\n    if (open) {\n      const width = `${rootRef.current?.clientWidth}px`;\n      if (width !== popupDimensions?.width) {\n        setPopupDimensions({ width });\n      }\n    }\n  }, [open, popupDimensions]);\n\n  // set active option and selection based on typing\n  const getOptionFromInput = (inputValue: string): OptionValue | undefined => {\n    const searchString = inputValue?.trim().toLowerCase();\n\n    if (!searchString || searchString.length === 0) {\n      return;\n    }\n\n    const matcher = (optionText: string) => optionText.toLowerCase().indexOf(searchString) === 0;\n    const matches = getOptionsMatchingText(matcher);\n\n    // return first matching option after the current active option, looping back to the top\n    if (matches.length > 1 && activeOption) {\n      const startIndex = getIndexOfId(activeOption.id);\n      const nextMatch = matches.find(option => getIndexOfId(option.id) >= startIndex);\n      return nextMatch ?? matches[0];\n    }\n\n    return matches[0] ?? undefined;\n  };\n\n  /* Handle typed input */\n\n  // reset any typed value when an option is selected\n  baseState.selectOption = (ev: SelectionEvents, option: OptionValue) => {\n    setValue(undefined);\n    selectOption(ev, option);\n  };\n\n  const onTriggerBlur = (ev: React.FocusEvent<HTMLInputElement>) => {\n    // handle selection and updating value if freeform is false\n    if (!baseState.open && !freeform) {\n      // select matching option, if the value fully matches\n      if (value && activeOption && value.trim().toLowerCase() === activeOption?.text.toLowerCase()) {\n        baseState.selectOption(ev, activeOption);\n      }\n\n      // reset typed value when the input loses focus while collapsed, unless freeform is true\n      setValue(undefined);\n    }\n  };\n\n  baseState.setOpen = (ev, newState: boolean) => {\n    if (disabled) {\n      return;\n    }\n\n    if (!newState && !freeform) {\n      setValue(undefined);\n    }\n\n    setOpen(ev, newState);\n  };\n\n  // update value and active option based on input\n  const onTriggerChange = (ev: React.ChangeEvent<HTMLInputElement>) => {\n    const inputValue = ev.target.value;\n    // update uncontrolled value\n    baseState.setValue(inputValue);\n\n    // handle updating active option based on input\n    const matchingOption = getOptionFromInput(inputValue);\n    setActiveOption(matchingOption);\n\n    setFocusVisible(true);\n\n    // clear selection for single-select if the input value no longer matches the selection\n    if (!multiselect && selectedOptions.length === 1 && (inputValue.length < 1 || !matchingOption)) {\n      clearSelection(ev);\n    }\n  };\n\n  // open Combobox when typing\n  const onTriggerKeyDown = (ev: React.KeyboardEvent<HTMLInputElement>) => {\n    if (!open && getDropdownActionFromKey(ev) === 'Type') {\n      baseState.setOpen(ev, true);\n    }\n\n    // clear activedescendant when moving the text insertion cursor\n    if (ev.key === ArrowLeft || ev.key === ArrowRight) {\n      setHideActiveDescendant(true);\n    } else {\n      setHideActiveDescendant(false);\n    }\n  };\n\n  // resolve input and listbox slot props\n  let triggerSlot: Slot<'input'>;\n  let listboxSlot: Slot<typeof Listbox> | undefined;\n\n  triggerSlot = resolveShorthand(props.input, {\n    required: true,\n    defaultProps: {\n      ref: useMergedRefs(props.input?.ref, triggerRef),\n      type: 'text',\n      value: value ?? '',\n      ...triggerNativeProps,\n    },\n  });\n\n  triggerSlot.onChange = mergeCallbacks(triggerSlot.onChange, onTriggerChange);\n  triggerSlot.onBlur = mergeCallbacks(triggerSlot.onBlur, onTriggerBlur);\n  triggerSlot.onKeyDown = mergeCallbacks(triggerSlot.onKeyDown, onTriggerKeyDown);\n\n  // only resolve listbox slot if needed\n  listboxSlot =\n    open || hasFocus\n      ? resolveShorthand(props.listbox, {\n          required: true,\n          defaultProps: {\n            children: props.children,\n            style: popupDimensions,\n          },\n        })\n      : undefined;\n\n  [triggerSlot, listboxSlot] = useComboboxPopup(props, triggerSlot, listboxSlot);\n  [triggerSlot, listboxSlot] = useTriggerListboxSlots(props, baseState, ref, triggerSlot, listboxSlot);\n\n  if (hideActiveDescendant) {\n    triggerSlot['aria-activedescendant'] = undefined;\n  }\n\n  const state: ComboboxState = {\n    components: {\n      root: 'div',\n      input: 'input',\n      expandIcon: 'span',\n      listbox: Listbox,\n    },\n    root: resolveShorthand(props.root, {\n      required: true,\n      defaultProps: {\n        'aria-owns': !inlinePopup ? listboxSlot?.id : undefined,\n        ...rootNativeProps,\n      },\n    }),\n    input: triggerSlot,\n    listbox: listboxSlot,\n    expandIcon: resolveShorthand(props.expandIcon, {\n      required: true,\n      defaultProps: {\n        'aria-expanded': open,\n        children: <ChevronDownIcon />,\n        role: 'button',\n      },\n    }),\n    ...baseState,\n  };\n\n  state.root.ref = useMergedRefs(state.root.ref, rootRef);\n\n  /* handle open/close + focus change when clicking expandIcon */\n  const { onMouseDown: onIconMouseDown, onClick: onIconClick } = state.expandIcon || {};\n  const onExpandIconMouseDown = useEventCallback(\n    mergeCallbacks(onIconMouseDown, () => {\n      // do not dismiss on blur when closing via clicking the icon\n      if (open) {\n        baseState.ignoreNextBlur.current = true;\n      }\n    }),\n  );\n\n  const onExpandIconClick = useEventCallback(\n    mergeCallbacks(onIconClick, (event: React.MouseEvent<HTMLSpanElement>) => {\n      // open and set focus\n      state.setOpen(event, !state.open);\n      triggerRef.current?.focus();\n\n      // set focus visible=false, since this can only be done with the mouse/pointer\n      setFocusVisible(false);\n    }),\n  );\n\n  if (state.expandIcon) {\n    state.expandIcon.onMouseDown = onExpandIconMouseDown;\n    state.expandIcon.onClick = onExpandIconClick;\n\n    // If there is no explicit aria-label, calculate default accName attribute for expandIcon button,\n    // using the following steps:\n    // 1. If there is an aria-label, it is \"Open [aria-label]\"\n    // 2. If there is an aria-labelledby, it is \"Open [aria-labelledby target]\" (using aria-labelledby + ids)\n    // 3. If there is no aria-label/ledby attr, it falls back to \"Open\"\n    // We can't fall back to a label/htmlFor name because of https://github.com/w3c/accname/issues/179\n    const hasExpandLabel = state.expandIcon['aria-label'] || state.expandIcon['aria-labelledby'];\n    const defaultOpenString = 'Open'; // this is english-only since it is the fallback\n    if (!hasExpandLabel) {\n      if (props['aria-labelledby']) {\n        const chevronId = state.expandIcon.id ?? `${comboId}-chevron`;\n        const chevronLabelledBy = `${chevronId} ${state.input['aria-labelledby']}`;\n\n        state.expandIcon['aria-label'] = defaultOpenString;\n        state.expandIcon.id = chevronId;\n        state.expandIcon['aria-labelledby'] = chevronLabelledBy;\n      } else if (props['aria-label']) {\n        state.expandIcon['aria-label'] = `${defaultOpenString} ${props['aria-label']}`;\n      } else {\n        state.expandIcon['aria-label'] = defaultOpenString;\n      }\n    }\n  }\n\n  return state;\n};\n"],"mappings":"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"}