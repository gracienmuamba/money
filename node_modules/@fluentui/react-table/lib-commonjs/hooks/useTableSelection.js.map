{"version":3,"names":["React","require","react_utilities_1","selectionManager_1","noop","undefined","exports","defaultTableSelectionState","allRowsSelected","clearRows","deselectRow","isRowSelected","selectRow","selectedRows","Set","someRowsSelected","toggleAllRows","toggleRow","selectionMode","useTableSelection","options","tableState","useTableSelectionState","items","getRowId","defaultSelectedItems","selectedItems","onSelectionChange","selected","setSelected","useControllableState","initialState","defaultState","useMemo","createSetFromIterable","state","selectionManager","createSelectionManager","e","newSelectedItems","useEventCallback","toggleAllItems","map","item","i","_a","rowId","toggleItem","deselectItem","selectItem","isSelected","selection","size","length","clearItems","iterable"],"sources":["../src/packages/react-components/react-table/src/hooks/useTableSelection.ts"],"sourcesContent":["import * as React from 'react';\nimport { useControllableState, useEventCallback } from '@fluentui/react-utilities';\nimport { createSelectionManager } from './selectionManager';\nimport type { TableRowId, TableSelectionState, TableFeaturesState, UseTableSelectionOptions } from './types';\n\nconst noop = () => undefined;\n\nexport const defaultTableSelectionState: TableSelectionState = {\n  allRowsSelected: false,\n  clearRows: noop,\n  deselectRow: noop,\n  isRowSelected: () => false,\n  selectRow: noop,\n  selectedRows: new Set(),\n  someRowsSelected: false,\n  toggleAllRows: noop,\n  toggleRow: noop,\n  selectionMode: 'multiselect',\n};\n\nexport function useTableSelection<TItem>(options: UseTableSelectionOptions) {\n  // False positive, these plugin hooks are intended to be run on every render\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  return (tableState: TableFeaturesState<TItem>) => useTableSelectionState(tableState, options);\n}\n\nexport function useTableSelectionState<TItem>(\n  tableState: TableFeaturesState<TItem>,\n  options: UseTableSelectionOptions,\n): TableFeaturesState<TItem> {\n  const { items, getRowId } = tableState;\n  const { selectionMode, defaultSelectedItems, selectedItems, onSelectionChange } = options;\n\n  const [selected, setSelected] = useControllableState<Set<TableRowId>>({\n    initialState: new Set(),\n    defaultState: React.useMemo(\n      () => defaultSelectedItems && createSetFromIterable(defaultSelectedItems),\n      [defaultSelectedItems],\n    ),\n    state: React.useMemo(() => selectedItems && createSetFromIterable(selectedItems), [selectedItems]),\n  });\n\n  const selectionManager = React.useMemo(() => {\n    return createSelectionManager(selectionMode, (e, newSelectedItems) => {\n      setSelected(() => {\n        onSelectionChange?.(e as React.SyntheticEvent, { selectedItems: newSelectedItems });\n        return newSelectedItems;\n      });\n    });\n  }, [onSelectionChange, selectionMode, setSelected]);\n\n  const toggleAllRows: TableSelectionState['toggleAllRows'] = useEventCallback(e => {\n    selectionManager.toggleAllItems(\n      e,\n      items.map((item, i) => getRowId?.(item) ?? i),\n      selected,\n    );\n  });\n\n  const toggleRow: TableSelectionState['toggleRow'] = useEventCallback((e, rowId: TableRowId) =>\n    selectionManager.toggleItem(e, rowId, selected),\n  );\n\n  const deselectRow: TableSelectionState['deselectRow'] = useEventCallback((e, rowId: TableRowId) =>\n    selectionManager.deselectItem(e, rowId, selected),\n  );\n\n  const selectRow: TableSelectionState['selectRow'] = useEventCallback((e, rowId: TableRowId) =>\n    selectionManager.selectItem(e, rowId, selected),\n  );\n\n  const isRowSelected: TableSelectionState['isRowSelected'] = (rowId: TableRowId) =>\n    selectionManager.isSelected(rowId, selected);\n\n  return {\n    ...tableState,\n    selection: {\n      selectionMode,\n      someRowsSelected: selected.size > 0,\n      allRowsSelected: selectionMode === 'single' ? selected.size > 0 : selected.size === items.length,\n      selectedRows: selected,\n      toggleRow,\n      toggleAllRows,\n      clearRows: selectionManager.clearItems,\n      deselectRow,\n      selectRow,\n      isRowSelected,\n    },\n  };\n}\n\n/**\n * Creates a set from a given iterable, in case the iterable is a set itself, returns the given set instead.\n */\nfunction createSetFromIterable<V>(iterable: Iterable<V>): Set<V> {\n  return iterable instanceof Set ? iterable : new Set(iterable);\n}\n"],"mappings":"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"}